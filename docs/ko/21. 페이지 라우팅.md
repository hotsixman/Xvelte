# 21. 페이지 라우팅

Xvelte는 페이지 경로를 정의하는 두 가지 방법을 제공합니다: **프로그래밍 방식**과 **파일 시스템 기반 방식**입니다. 두 방법을 함께 사용할 수 있으며, 우선순위는 프로그래밍 방식이 더 높습니다.

## 1. 프로그래밍 방식 라우팅 (우선순위 높음)

`XvelteApp` 인스턴스의 `page` 메소드를 사용하여 직접 경로와 핸들러를 등록하는 방식입니다. 여기서 등록된 경로는 파일 시스템 기반 라우팅보다 먼저 확인됩니다.

```ts
// app.ts (애플리케이션 시작 파일)

import { XvelteApp } from '@hotsixman/xvelte';
import IndexPage from './page/index.svelte';

const app = new XvelteApp(template);

app.page('/', (event) => {
    return {
        component: IndexPage
    };
});
```

### 핸들러의 반환 값

`page` 메소드에 전달되는 핸들러는 렌더링할 컴포넌트 정보를 담은 객체를 반환해야 합니다.

-   `component`: **(필수)** 페이지의 본문이 될 Svelte 컴포넌트입니다.
-   `props` (선택 사항): `component`에 전달할 프로퍼티(props)입니다.
-   `layouts` (선택 사항): 페이지를 감싸는 레이아웃 컴포넌트의 배열입니다.

```ts
import Layout from './page/layout.svelte';

app.page('/some-page', (event) => {
    return {
        layouts: [
            { component: Layout, props: { title: '페이지 제목' } }
        ],
        component: SomePage,
        props: { pageData: { id: 1 } }
    };
});
```

## 2. 파일 시스템 기반 라우팅

`src/routes` 디렉토리 안에 특정 규칙에 따라 파일을 생성하여 페이지를 정의하는 방식입니다. 프로그래밍 방식으로 등록된 경로 중에 일치하는 것이 없을 때 이 방식이 사용됩니다.

페이지는 `+server.ts` 파일 안에 `page`라는 이름의 상수를 `export`하여 정의합니다.

### 기본 구조

```typescript
// src/routes/blog/[slug]/+server.ts

import type { PageHandler } from '@hotsixman/xvelte';
import BlogLayout from '../../layouts/BlogLayout.svelte';
import PostPage from './PostPage.svelte';

// 'page'라는 이름으로 핸들러를 export 합니다.
export const page: PageHandler = (event) => {
    // event.params에서 동적 파라미터(slug)를 얻을 수 있습니다.
    const { slug } = event.params;

    // 서버 사이드에서 데이터 로딩
    const post = { title: `Post ${slug}`, content: '...' };

    return {
        layouts: [
            { component: BlogLayout }
        ],
        component: PostPage,
        props: {
            post: post
        }
    };
};
```

### 경로 규칙

URL 경로는 `src/routes` 디렉토리 내의 `+server.ts` 파일 위치에 따라 결정됩니다.

| 파일 경로                               | 생성되는 URL 경로 | 설명                               |
| --------------------------------------- | ----------------- | ---------------------------------- |
| `src/routes/+server.ts`                 | `/`               | 루트 페이지                        |
| `src/routes/about/+server.ts`           | `/about`          | 정적 경로 페이지                   |
| `src/routes/blog/[slug]/+server.ts`     | `/blog/:slug`     | 동적 파라미터를 받는 페이지        |
| `src/routes/files/[...path]/+server.ts` | `/files/*`        | 모든 하위 경로를 포함하는 페이지   |

## 최종 우선순위

요청이 들어왔을 때 Xvelte는 다음 순서로 일치하는 페이지 핸들러를 찾습니다.

1.  `app.page()`로 등록된 **프로그래밍 방식 라우트**
2.  `src/routes` 폴더 내의 **파일 시스템 기반 라우트**

예를 들어, `app.page('/about', ...)`가 등록되어 있고 `src/routes/about/+server.ts` 파일도 존재한다면, `/about` 경로로 요청 시 `app.page()`로 등록한 핸들러가 실행됩니다.

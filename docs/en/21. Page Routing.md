# 21. Page Routing

Xvelte provides two methods for defining page routes: **programmatic** and **file-system based**. Both methods can be used together, with the programmatic approach having higher priority.

## 1. Programmatic Routing (High Priority)

This method involves directly registering a path and a handler using the `page` method of the `XvelteApp` instance. Routes registered here are checked before file-system based routes.

```ts
// app.ts (Application entry file)

import { XvelteApp } from '@hotsixman/xvelte';
import IndexPage from './page/index.svelte';

const app = new XvelteApp(template);

app.page('/', (event) => {
    return {
        component: IndexPage
    };
});
```

### Handler's Return Value

The handler passed to the `page` method must return an object containing rendering information.

-   `component`: **(Required)** The Svelte component that will be the body of the page.
-   `props` (Optional): The properties (props) to be passed to the `component`.
-   `layouts` (Optional): An array of layout components that will wrap the page.

```ts
import Layout from './page/layout.svelte';

app.page('/some-page', (event) => {
    return {
        layouts: [
            { component: Layout, props: { title: 'Page Title' } }
        ],
        component: SomePage,
        props: { pageData: { id: 1 } }
    };
});
```

## 2. File-System Based Routing

This method involves defining pages by creating files according to specific rules within the `src/routes` directory. This method is used when there is no match among the programmatically registered routes.

Pages are defined by exporting a constant named `page` within a `+server.ts` file.

### Basic Structure

```typescript
// src/routes/blog/[slug]/+server.ts

import type { PageHandler } from '@hotsixman/xvelte';
import BlogLayout from '../../layouts/BlogLayout.svelte';
import PostPage from './PostPage.svelte';

// Export a handler named 'page'
export const page: PageHandler = (event) => {
    // You can get the dynamic parameter (slug) from event.params
    const { slug } = event.params;

    // Load data on the server side
    const post = { title: `Post ${slug}`, content: '...' };

    return {
        layouts: [
            { component: BlogLayout }
        ],
        component: PostPage,
        props: {
            post: post
        }
    };
};
```

### Path Rules

URL paths are determined by the location of the `+server.ts` file within the `src/routes` directory.

| File Path                               | Generated URL Path | Description                        |
| --------------------------------------- | ------------------ | ---------------------------------- |
| `src/routes/+server.ts`                 | `/`                | Root page                          |
| `src/routes/about/+server.ts`           | `/about`           | Static route page                  |
| `src/routes/blog/[slug]/+server.ts`     | `/blog/:slug`      | Page that accepts a dynamic parameter |
| `src/routes/files/[...path]/+server.ts` | `/files/*`         | Page that includes all sub-paths   |

## Final Priority

When a request comes in, Xvelte finds a matching page handler in the following order:

1.  **Programmatic routes** registered with `app.page()`
2.  **File-system based routes** within the `src/routes` folder

For example, if `app.page('/about', ...)` is registered and a `src/routes/about/+server.ts` file also exists, the handler registered with `app.page()` will be executed for requests to the `/about` path.
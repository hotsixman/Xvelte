# 30. Islands (Partial Hydration)

One of the main features of Xvelte is a rendering strategy called the **Island Architecture**, or **Partial Hydration**. This approach aims to improve the initial loading performance of a website.

## The Problem with Traditional Hydration

Traditional Server-Side Rendering (SSR) frameworks send HTML generated on the server to the client, and then go through a 'hydration' process that downloads the JavaScript for the entire page to attach event handlers and state to the DOM elements. While this method makes all components on the page interactive, it has the disadvantage that the more complex the page, the larger the amount of JavaScript, leading to longer initial loading and Time to Interactive (TTI).

## Xvelte's Solution: Islands

Xvelte solves this problem with the concept of 'islands'. If you view the entire page as a large continent, only the parts that require interaction (e.g., buttons, image sliders, autocomplete search bars) are treated as 'islands'.

- **Static HTML by Default**: Most of the page remains as pure HTML with no interaction.
- **Only Islands are Activated**: Only the components that need to be interactive are 'activated (hydrated)' with JavaScript.

This allows the client to download and execute only the minimum amount of JavaScript needed to render the page, so users can see and interact with the page much faster.

## How to Use

You can easily specify an island in Xvelte using the built-in `<Island>` component.

### Component Import: The `?client` Suffix (Very Important)

When importing a component that you want to turn into an island, you **must** append the `?client` suffix to the end of the path.

```ts
import Counter from '../components/Counter.svelte?client';
```

This suffix is a crucial indicator to Xvelte's build system (Vite) that the `Counter.svelte` component needs to be hydrated on the client side. This flag ensures that the component's JavaScript code is generated as a separate bundle to be sent to the client. **If you do not follow this rule, the island will not work.**

### `<Island>` Component Usage Example

After importing the component with `?client`, you can pass it to the `component` prop of the `<Island>` component, and pass initial data through the `props` prop.

```svelte
<!-- page/Index.svelte -->
<script>
    import Counter from '../components/Counter.svelte?client';
    import Island from '@hotsixman/xvelte/components/Island.svelte';
</script>

<h1>Static Content</h1>
<p>This part is not hydrated.</p>

<!-- Designate the Counter component as an island -->
<Island component={Counter} props={{ initialValue: 5 }} />
```

In the example above, the `<h1>` and `<p>` tags remain as pure HTML, but only the `Counter` component wrapped with `<Island>` is hydrated on the client and becomes interactive.

### Controlling Hydration Timing

You can control when to load the JavaScript and activate the component using the `on` prop of the `<Island>` component. This is very useful for performance optimization.

-   **`on="visible"`**: Activates when the user scrolls and the component first becomes visible in the viewport. Good for components at the bottom of the page.
-   **`on="click"`**: Activates when the component is first clicked. Suitable for cases where immediate interaction is not necessary, such as modal windows or dropdown menus.
-   **`on="mouseenter"`**: Activates when the user moves the mouse cursor over the component area.
-   **If the `on` prop is not specified**: Activates immediately as soon as the page loads.

```svelte
<script>
    import HeavyComponent from '../components/HeavyComponent.svelte?client';
    import Island from '@hotsixman/xvelte/components/Island.svelte';
</script>

<!-- A heavy component that only loads when it becomes visible -->
<Island component={HeavyComponent} on="visible" />
```

As you can see, Xvelte's island feature is a useful tool for improving website performance.